var ajax_http_service=function(){this.get=function(t,e,a){var n,a={hackeet_client_data:a,connection_id:hackeet.read_session_data("connection_id"),token:hackeet.read_session_data("token"),app_token:hackeet.read_session_data("app_token")};return $.ajax({url:t,async:!1,data:a,success:function(t){n=t,e&&e(t)}}),n},this.post=function(t,e,a,n){var i,t={url:t,type:"POST",async:!1,data:{hackeet_client_data:a,connection_id:hackeet.read_session_data("connection_id"),token:hackeet.read_session_data("token"),app_token:hackeet.read_session_data("app_token")},success:function(t){i=t,e&&e(t)}};return null!=n&&(null!=n.processData&&(t.processData=n.processData),null!=n.contentType)&&(t.processData=n.contentType),$.ajax(t),i},this.post_form=function(t,e,a){var n;return $.ajax({url:t,type:"POST",data:a,processData:!1,contentType:!1,success:function(t){n=t,e&&e(t)}}),n}},angular_http_service=function(n){this.get=function(e,a,t){t={hackeet_client_data:t,connection_id:hackeet.read_session_data("connection_id"),token:hackeet.read_session_data("token"),app_token:hackeet.read_session_data("app_token")};n.get(e,t).then(function(t){a&&a(t.data)},function(t){alert("angular_get : error : url : "+e+" : what = "+JSON.stringify(t))})},this.post=function(t,e,a){a={hackeet_client_data:a,connection_id:hackeet.read_session_data("connection_id"),token:hackeet.read_session_data("token"),app_token:hackeet.read_session_data("app_token")};n.post(t,a).then(function(t){e&&e(t.data)},function(t){alert("angular_post : error :  "+JSON.stringify(t))})}},HACKEET_INTERNAL_ADMIN_START="admin::start",HACKEET_INTERNAL_ADMIN_ROBOT_OUTPUT="bot::output",HACKEET_INTERNAL_ADMIN_ROBOT_INPUT="bot::input",CONNECTION_TIMEOUT_MS=1e3;function hackeet_test_load(){console.log("Hackeet Javascript library successfully loaded")}(o=>{o.fn.persist=function(i,t,e){return null==i&&(i={}),o(t=null==t?".persistent":t).each(function(){var t,e,a=o(this).attr("name"),n=o(this).attr("type");null!=a&&(n==HACKEET_RADIO_BLOCK_TYPE?o(this).find("input:checked").each(function(){e=o(this).attr("value")}):n==HACKEET_CHECKBOX_BLOCK_TYPE?(e=t="",o(this).find("input:checked").each(function(){e+=t+o(this).val(),t=ITEM_VALUES_SEPARATOR})):n==HACKEET_SWITCH_BLOCK_TYPE?o(this).find("input:checked").each(function(){e=o(this).val()}):e=o(this).val(),i[a]=e)}),i},o.fn.restore=function(_,t){null==t&&(t=".persistent"),null!=_&&o(t).each(function(){var t=o(this).attr("name"),e=o(this).attr("id"),a=o(this).attr("type"),n=o(this).attr("bot_input");if(null!=t&&null!=n){n=_[n],n=null!=n?n[t]:null;if(null!=n)if(a==HACKEET_RADIO_BLOCK_TYPE){var i=hackeet.radio_button_id(t,n);o(this).find("#"+i).prop("checked",n)}else if(a==HACKEET_CHECKBOX_BLOCK_TYPE){var l=n;0==Array.isArray(n)&&(l=JSON.parse('{ "array" : '+n+"}").array,0==Array.isArray(l))&&(l=[n]);for(var r=0;r<l.length;++r){var s=hackeet.radio_button_id(t,l[r]);o(this).find("#"+s).prop("checked",!0)}}else a==HACKEET_SWITCH_BLOCK_TYPE?(i="1"==n||1==n,o("#"+hackeet.switch_input_block_on_id(e)).prop("checked",i),o("#"+hackeet.switch_input_block_off_id(e)).prop("checked",!i)):o(this).val(n)}})}})(jQuery);var Webflow=Webflow||[],Hackeet={Webflow:{forms:{bind:function(e){Webflow.push(function(){(null!=e?$(e):$(document)).off("submit");function t(t){t.preventDefault();var e=$(this),a=$("[type=submit]",e),n=a.val(),t=a.attr("data-wait"),i=e.attr("method"),l=e.attr("action"),r=e.attr("data-redirect"),s=e.serialize();t&&a.val(t),$.ajax(l,{data:s,method:i}).done(function(t){r?window.location=r:e.hide().siblings(".w-form-done").show().siblings(".w-form-fail").hide()}).fail(function(t){e.siblings(".w-form-done").hide().siblings(".w-form-fail").show()}).always(function(){a.val(n)})}(null==e?$("form"):$(e)).submit(t)})}}}},hackeet={g_global_index:0,get_object_id:function(){return"hackeet_obj_"+String(++hackeet.g_global_index)},form_storage:{},attribute:function(t,e){if(null==t||null==e)return null;var a,n=t;for(a in e)if(null==(n=t[e[a]]))break;return n},query_selector_name:function(t){return" #"+t},query_selector_class:function(t){return" ."+t+" "},store_session_data:function(t,e){"undefined"!=typeof Storage&&(sessionStorage[t]=e)},read_session_data:function(t){if("undefined"!=typeof Storage)return sessionStorage[t]},delete_session_data:function(t){"undefined"!=typeof Storage&&delete sessionStorage[t]},parse_url_query:function(t){for(var e=t.split("&"),a={},n=0;n<e.length;++n){var i=e[n].split("=");a[i[0]]=i[1]}return a},url_query:function(){var t=location.search.substring(1);return hackeet.parse_url_query(t)},server_url:function(t){return t+"/server.js/"},debug:function(t,e){e="[log"+(null==e?"::":"::"+e+"::")+new Date+"]";console.log(e+JSON.stringify(t))},deep_clone:function(t,e){if(t!=e&&null!=e){for(var a in null==t&&(t={}),e){var n=e[a];n instanceof Object?(null==t[a]&&(t[a]=Object.create(n)),hackeet.deep_clone(t[a],e[a])):null!=e[a]&&(t[a]=e[a])}return t}},dataset_color:function(t){var e=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"];return e[t%e.length]},default_allocate:function(t){return t=null==t?{}:t},dom_exists:function(t){return null!=document.getElementById(t)},dom_assign:function(t,e){null!=t&&1==hackeet.dom_exists(t)?document.getElementById(t).innerHTML=e:hackeet.debug({id:t,value:e},"Warning:: DOM Assignment Error")},assert:function(t,e){return null==t?e+" is null,":""},add_zero:function(t){return t=t<10?"0"+t:t},save_state:function(){null!=$.fn.persist&&$(this).find("form").persist(hackeet.form_storage)},restore_state:function(t){null!=$.fn.restore&&$(this).find("form").restore(hackeet.form_storage,t)},set_state:function(t,e){null!=t&&null!=e&&(null==hackeet.form_storage[t]&&(hackeet.form_storage[t]={}),Object.assign(hackeet.form_storage[t],e))},load_state:function(t,e){null!=t&&null!=e&&null==hackeet.form_storage[e]&&t.state(e,function(t){null!=t&&""!=t&&hackeet.set_state(e,t)})},warn:function(t){return null!=t&&alert(t),t},client_instance:function(t){var e=t.url,s=t.websocket,a=t.on_server_connect,n=t.on_ws_connect,i=t.http,l=t.raw_hackeet_address_scheme,o=this;function r(t,e){return t.hasOwnProperty(e)?t[e]:t[e]={}}this.m_websocket={},this.m_robot_outputs_handlers={fields:{},outputs:{}},this.m_robot_inputs_handlers={},this.m_robot_states_handlers={},this.m_server_name="",this.m_on_server_connect=a,this.m_on_ws_connect=n,this.m_message_response={},this.m_url=null===e?"":e,this.m_raw_hackeet_address_scheme=l,this.m_websockets_support=null==t.websockets||0!=t.websockets,this.m_ws_connected=!1,this.m_ws_channel=t.channel,this.m_ws_secret=t.secret,1==l&&i.get(hackeet.server_url(this.m_url),function(t){o.actual_server_name=t,o.m_server_name=t.replace(/ /g,"_")},null),this.base_url=function(){return o.m_url+"/"+o.m_server_name},this.start_url=function(){return 1!=this.m_raw_hackeet_address_scheme?warn("start_url : not_available"):o.base_url()+"/admin/start"},this.stop_url=function(){return 1!=this.m_raw_hackeet_address_scheme?warn("stop_url : not_available"):o.base_url()+"/admin/stop"},this.definition_url=function(){return 1!=this.m_raw_hackeet_address_scheme?warn("definition_url : not_available"):o.base_url()+"/admin/definition.js"},this.authorization_url=function(){return 1!=this.m_raw_hackeet_address_scheme?warn("authorization_url : not_available"):o.base_url()+"/admin/authorization"},this.async_entry_url=function(t){return 1!=this.m_raw_hackeet_address_scheme?o.base_url()+"/async/"+t:o.base_url()+"/input/message/"+t},this.sync_entry_url=function(t){return 1!=this.m_raw_hackeet_address_scheme?o.base_url()+t:o.base_url()+"/input/http/"+t},this.js_entry_url=function(t){return 1!=this.m_raw_hackeet_address_scheme?warn("js_entry_url : not_available"):o.base_url()+"/input/js/"+t},this.pages_url=function(t){return 1!=this.m_raw_hackeet_address_scheme?warn("pages_url : not_available"):o.base_url()+"/admin/pages.js"},this.input_state_url=function(t){return o.base_url()+"/admin/state/"+t},this.server_name_url=function(){return hackeet.server_url(o.m_url)},this.broadcast=function(t){if(t.type===HACKEET_INTERNAL_ADMIN_ROBOT_OUTPUT){var e,a=o.m_robot_outputs_handlers.fields[t.output];for(e in a){var n,i=a[e];for(n in i)t.record.hasOwnProperty(e)&&i[n](t.record[e])}var l,r=o.m_robot_outputs_handlers.outputs[t.output];for(l in r)(0,r[l])(t.output,t.record)}else if(t.type===HACKEET_INTERNAL_ADMIN_ROBOT_INPUT){var s,_=o.m_robot_inputs_handlers;for(s in _)(0,_[s])(t.input,t.params)}},this.start=function(){!function e(a){var t,n,i,l,r;1!=o.m_websockets_support?o.build():(t=location.hostname.toLowerCase(),t=("http"==location.protocol.toLowerCase().replace(":","")?"ws":"wss")+"://"+t+":"+location.port.toLowerCase()+"/"+s,r=null!=a.m_url?a.m_url.trim():"",""!=a.m_url.trim()&&a.m_url.trim().toLowerCase(),n=""!=r,i=a.m_ws_channel,l=a.m_ws_secret,r=r.replace("http","ws")+"/"+s,a.m_websocket=new WebSocket(n?r:t),a.m_websocket.onopen=function(){null==l&&null==i||a.m_websocket.send(JSON.stringify({secret:l,channel:i})),null!=o.m_on_ws_connect&&"function"==typeof o.m_on_ws_connect&&o.m_on_ws_connect()},a.m_websocket.onclose=function(){for(var t in a.m_robot_states_handlers)(0,a.m_robot_states_handlers[t])("close");setTimeout(e(a),CONNECTION_TIMEOUT_MS)},a.m_websocket.onmessage=function(t){for(var e in a.m_message_response=JSON.parse(t.data),a.m_message_response.type===HACKEET_INTERNAL_ADMIN_START&&(hackeet.store_session_data("connection_id",a.m_message_response.connection_id),0==o.m_ws_connected)&&o.m_raw_hackeet_address_scheme&&(o.m_ws_connected=!0,o.build()),a.m_robot_states_handlers)(0,a.m_robot_states_handlers[e])("receive",a.m_message_response);a.broadcast(a.m_message_response)})}(this)},this.build=function(){this.m_on_server_connect&&i.get(o.definition_url(),function(t){o.m_on_server_connect(o,t)})},this.add_handler=function(t,e,a,n){t=r(o.m_robot_outputs_handlers.fields,t);r(t,e)[a]=n},this.remove_handler=function(t,e,a,n){t=r(o.m_robot_outputs_handlers.fields,t);delete r(t,e)[a]},this.add_input_handler=function(t,e){o.m_robot_inputs_handlers[t]=e},this.remove_input_handler=function(t){delete o.m_robot_inputs_handlers[t]},this.start_server=function(){i.get(o.start_url())},this.stop_server=function(){i.get(o.stop_url())},this.post=function(t,e,a){i.post(t,function(t){null!=a&&(t=t instanceof Object?t:JSON.parse(t),a(t.output,t.record))},e)},this.push=function(t,e,a,n){o.post(null==a||1==n?o.async_entry_url(t):o.sync_entry_url(t),e,a)},this.websocket_push=function(t,e){null!=this.m_websocket&&o.m_websocket.send(JSON.stringify({input:t,values:null==e?{}:e}))},this.fetch=function(t,l){null!=l&&(null==l.facet&&(l.facet=function(t,e,a,n){document.getElementById(t).innerHTML=n[e],$("#"+t).val(n[e])}),o.push(t,l.data,function(t,e){for(var a in l.map){var n,i=document.getElementById(a);null!=i&&(n=l.map[a],"function"==typeof l.facet?l.facet(a,n,t,e):"function"==typeof n?n(a,n,t,e):i.innerHTML=null!=n?e[n]:"")}},l.async))},this.websocket_fetch=function(t,e,l){var r,s;null!=l&&(null==l.facet&&(l.facet=function(t,e,a,n){document.getElementById(t).innerHTML=n[e],$("#"+t).val(n[e])}),r=o.register_handler({output:e},function(t,e){for(var a in l.map){var n,i=document.getElementById(a);null!=i&&(n=l.map[a],"function"==typeof l.facet?l.facet(a,n,t,e):"function"==typeof n?n(a,n,t,e):i.innerHTML=null!=n?e[n]:"")}0==s&&(r.container[r.id]=null)}),s=1==l.keep_alive,o.websocket_push(t,l.data))},this.state=function(t,e){1==o.m_raw_hackeet_address_scheme&&(t=o.input_state_url(t),i.get(t,function(t){null!=e&&e(t)}))},this.state=function(t,e){1==o.m_raw_hackeet_address_scheme&&(t=o.input_state_url(t),i.get(t,function(t){null!=e&&e(t)}))},this.register_handler=function(t,e){var a;if(null!=t.field&&(t.field_id=t.field),null!=t.output&&(t.output_id=t.output),t.output_id&&e)return t.field_id?(a=r(t.field_id?o.m_robot_outputs_handlers.fields:o.m_robot_outputs_handlers.outputs,t.output_id),(a=r(a,t.field_id))[t.handler_id]=e,{container:a,id:t.handler_id}):(o.m_robot_outputs_handlers.outputs[t.output_id]||(o.m_robot_outputs_handlers.outputs[t.output_id]={}),o.m_robot_outputs_handlers.outputs[t.output_id][t.handler_id]=e,{container:o.m_robot_outputs_handlers.outputs[t.output_id],id:t.handler_id})},this.reset_handlers=function(){o.m_robot_outputs_handlers={fields:{},outputs:{}},o.m_robot_inputs_handlers={},o.m_robot_states_handlers={}},this.register_state_handler=function(t,e){o.m_robot_states_handlers[t.handler_id]=e},this.server_name=function(){return o.actual_server_name},this.service=function(){return i}},authorize:function(e,a,n){$("#"+a).submit(function(t){t.preventDefault();e.post(e.authorization_url(),$("#"+a).serialize(),function(t,e){var a;"authorized"===e.status&&(a=null!=n?n:"/",hackeet.store_session_data("token",e.token),hackeet.store_session_data("app_token",e.app_token),hackeet.store_session_data("user",e.msg.user),window.location.assign(a+"?token="+e.token+"&app_token="+e.app_token))})})},chart_factory:null,chart_factory_instance:function(){return null==hackeet.chart_factory?hackeet.charts.plotly:hackeet.chart_factory},blotter_instances:{},blotter:function(t){var e="<"+t.server_name()+">",a=hackeet.blotter_instances[e];return null==a?hackeet.blotter_instances[e]=new hackeet.blotters.instance(t,hackeet.chart_factory_instance()):a},screen:function(t,e){return hackeet.blotter(t).screen(e)},attach_form:function(t,e){return hackeet.blotter(t).form(e)},microphone:function(t,e,a){return hackeet.blotter(t).microphone(e,a)},record:function(t,e){return hackeet.blotter(t).record(e)},block:function(t,e,a){return hackeet.blotter(t).block(e,a)},update_nav_bar:function(t,e,a){return hackeet.blotter(t).update_nav_bar(e,a)},table:function(t,e){return hackeet.blotter(t).table(e)},linechart:function(t,e){return hackeet.blotter(t).chart(hackeet.chart_factory_instance().line,t,e)},columnchart:function(t,e){return hackeet.blotter(t).chart(hackeet.chart_factory_instance().column,t,e)},tablechart:function(t,e){return hackeet.blotter(t).chart(hackeet.chart_factory_instance().tablechart,t,e)},bubblechart:function(t,e){return hackeet.blotter(t).chart(hackeet.chart_factory_instance().bubble,t,e)},register_handler:function(t,e){null!=t&&null!=e&&t.register_handler(e,e.handler)},load_states:function(t,e){for(var a in e)hackeet.load_state(t,e[a])},widget:function(t,e){return hackeet.blotter(t).widget_impl(e)},default_screens:function(t,e){return hackeet.blotter(t).default_screens(e)},client:function(t,e){null==(e=null==e?{}:e).websockets&&(e.websockets=!1),null==e.raw_hackeet_address_scheme&&(e.raw_hackeet_address_scheme=!1),e.url=t,e.http=new ajax_http_service,e.websocket="ws";t=new hackeet.client_instance(e);return null!=t&&t.start(),t},fetch:function(t,e,a,n){hackeet.client(t).fetch(e,{data:n,map:a})},ws_fetch:function(t,e,a,n,i){var l=hackeet.client(t,{on_ws_connect:function(){l.websocket_fetch(e,a,{map:n,data:i})},raw_hackeet_address_scheme:!1});return l}},MAX_INLINE_RADIO_BUTTON_ITEM=1,ITEM_VALUES_SEPARATOR=":",HACKEET_CHECKBOX_BLOCK_TYPE="chekbox-block",HACKEET_RADIO_BLOCK_TYPE="radio-block",HACKEET_SWITCH_BLOCK_TYPE="switch-block",HACKEET_CLASS_PREFIX="hackeet_",HACKEET_DEFAULT_INPUT_HANDLER_ID="default_input_handler",HACKEET_DEFAULT_SM_TYPE=12,HACKEET_DEFAULT_WIDGET_BLOCK_UNIT="free-unit",HACKEET_SYNCHRONIZED_SELECTOR=".synchronized",SLIDER_TAG="slider",FORM_TAG="form",TEXT_TAG="text",PASSWORD_TAG="password",HIDDEN_TAG="hidden",NUMBER_TAG="number",COLOR_TAG="color",DATE_TAG="date",EMAIL_TAG="email",UPLOAD_TAG="file",RADIO_TAG="radio",INLINE_RADIO_TAG="radio-inline",CHECKBOX_TAG="checkbox",INLINE_CHECKBOX_TAG="checkbox-inline",ONOFF_TAG="switch",BUTTON_TAG="button",CALENDAR_TAG="calendar",LINE_CHART_TAG="line",COLUMN_CHART_TAG="column",BUBBLE_CHART_TAG="bubble",TABLE_CHART_TAG="table",RECORD_CHART_TAG="record",DEFAULT_TABLE_TAG="output",SUBMIT_BUTTON_TAG="submit";hackeet.standard_field_id=function(t,e){var a=Math.floor(1e6*Math.random());return null!=t&&null!=e?t+"_"+e+"_"+a.toString():"undefined"},hackeet.switch_input_block_on_id=function(t){return"on_"+t},hackeet.switch_input_block_off_id=function(t){return"off_"+t},hackeet.radio_button_id=function(t,e){return t+"_"+e},hackeet.get_input_id=function(t,e){return"input_entry_"+t+"_"+e},hackeet.get_bootstrap_type=function(t){t=null==t?HACKEET_DEFAULT_SM_TYPE:t;return'<div class="col-sm-'+t+" col-lg-"+t+'">'},hackeet.get_block_unit=function(t){return t||HACKEET_DEFAULT_WIDGET_BLOCK_UNIT},hackeet.get_table_item_id=function(t,e,a){return"table_item_"+t+"::"+e+"::"+a},hackeet.get_max_display_item_id=function(t,e,a){return"display_item_max_"+t+"::"+e+"::"+a},hackeet.get_min_display_item_id=function(t,e,a){return"display_item_min_"+t+"::"+e+"::"+a},hackeet.widget_block=function(t,e,a,n,i,l){t='<div id="hackeet.widget_block_'+t+'" class="hackeet_block '+hackeet.get_block_unit(i)+" "+(l||"")+'">';return e&&0<e.length&&(t+='<div class="hackeet-block-title">'+e+"</div>"),t=t+('<div class="info-user">'+a+"</div>")+(n+"</div>")},hackeet.switch_input_block=function(t,e,a,n,i,l){var i=null==i?"":i,r=hackeet.standard_field_id(hackeet.get_input_id(t,"form"),e),s=1==l.persistent?"persistent":"";return'<div type="'+HACKEET_SWITCH_BLOCK_TYPE+'" bot_input="'+t+'" class="switch '+s+" "+(1==l.synchronized?"synchronized":"")+" "+i+'" id="'+r+'" name="'+e+'"> \t\t\t\t\t       <input type="radio" class="switch-input hackeet-input immediate" name="'+e+'" value="0" id="'+hackeet.switch_input_block_off_id(r)+'" bot_input="'+t+'" checked>\t\t\t\t\t       <label for="'+hackeet.switch_input_block_off_id(r)+'" class="switch-label switch-label-off">'+n+'</label>                           <input type="radio" class="switch-input hackeet-input immediate" name="'+e+'" value="1" id="'+hackeet.switch_input_block_on_id(r)+'" bot_input="'+t+'">\t\t\t\t\t       <label for="'+hackeet.switch_input_block_on_id(r)+'" class="switch-label switch-label-on">'+a+'</label>\t\t\t\t\t       <span class="switch-selection"></span>\t\t\t\t       </div>'},hackeet.standard_input_block=function(t,e){var a=1==t.persistent?"persistent":"",n=null!=t.value?' value="'+t.value+'"':"";return'<input class="hackeet-input '+a+" "+(1==t.synchronized?"synchronized":"")+' immediate" bot_input="'+t.bot_input+'" type="'+e+'" id="'+t.field_id+'" name="'+t.field_name+'" placeholder="'+t.placeholder+'"'+n+">"},hackeet.generic_list_input_block=function(t,e,a,n,i,l,r){for(var s=i.buttons.split(":"),_="",o=s.length<=MAX_INLINE_RADIO_BUTTON_ITEM?l.inline:l.standard,c="",i=1==r.persistent?"persistent":"",r=1==r.synchronized?"synchronized":"",u=0;u<s.length;++u){var d=s[u],h=hackeet.radio_button_id(e,d);_+='<span class="immediate '+o+'" bot_input="'+n+'"><input class="hackeet-input" type="'+l.type+'" id="'+h+'" name="'+e+'" '+c+' value="'+d+'"><span class="hackeet-button-label">'+d+"</span></span>",c=""}return'<div bot_input="'+t+'"  type="'+(null!=l.block_type?l.block_type:"")+'" class="hackeet-inline-button-block '+i+" "+r+'" name="'+e+'">'+_+"</div>"},hackeet.blotters=null==hackeet.blotters?{}:hackeet.blotters,hackeet.blotters.instance=function(p,t){var k=this;this.form_has_button={},this.m_js_client=p,this.m_widgets={},this.m_widgets_impl={},this.m_input_handler=null,this.m_count=0,this.m_chart_factory=t,k.chart_factory=function(t){return null!=t&&(k.m_chart_factory=t),k.m_chart_factory},this.send_form_data=function(t,e,a,n,i,l){a.append("connection_id",hackeet.read_session_data("connection_id")),a.append("token",hackeet.read_session_data("token")),a.append("app_token",hackeet.read_session_data("app_token")),a.append("user",hackeet.read_session_data("user")),l.post_form(e,null,a),t&&t.preventDefault(),null!=n&&(l=hackeet.query_selector_name(i)+" "+n,$(l).val(""))},this.submit_form=function(t,e,a,n){var i=document.forms.namedItem(a),i=new FormData(i);k.send_form_data(t,e,i,n,a,p.service())},this.block=function(t,e){var a=null==e.target?t+"_custom_block"+"_impl":e.target,n=hackeet.widget_block(t,e.title,"",e.content,hackeet.get_block_unit(e.block_unit));return null!=e.form_block_div&&(n=e.form_block_div+n+"</div>"),hackeet.dom_assign(t,n),a},this.microphone=function(t,o){function e(t){document.getElementById(n).innerHTML=t,l("")}var a=t+"_microphone",n=t+"_info",i=t+"_error",l=(o.content='<center><div id="'+a+'"></div></center>                             <div class="hackeet_micro_display" id="'+(t+"_result")+'"></div>\t\t\t\t\t\t     <div class="hackeet_micro_display" id="'+n+'"></div>\t\t\t\t\t\t\t <div class="hackeet_micro_display" id="'+i+'"></div>',k.block(t,o),function(t){document.getElementById(i).innerHTML=t}),r=new Wit.Microphone(document.getElementById(a));return r.onready=o.onready||function(){e("Ready")},r.onaudiostart=o.onaudiostart||function(){e("Started")},r.onaudioend=o.onaudioend||function(){e("Processing...Double-Click to Reset")},r.onresult=o.onresult||function(t,e){var a,n={};for(a in e){var i=e[a];if(n[a]=[],i instanceof Array)for(var l=0;l<i.length;l++)n.push(i[l]);else n[a].push(i)}var r=k.m_js_client.async_entry_url(o.table_id),s={intent:t,entities:n},_=new FormData;_.append("intent",JSON.stringify(t)),_.append("json",JSON.stringify(s)),k.send_form_data(null,r,_,null,null,p.service())},r.onerror=o.onerror||function(t){l("Error: "+t)},r.onconnecting=o.onconnecting||function(){e("Connecting")},r.ondisconnected=o.ondisconnected||function(){e("Not connected")},r.connect(o.auth_token),$("#"+a).dblclick(function(){k.microphone(t,o)}),r},this.is_valid_chart_definition=function(t){var e,a=null!=t&&null!=t.id&&null!=t.field&&null!=t.field;return 0==a&&(e="",e=(e=(e+=hackeet.assert(t.field,"field"))+hackeet.assert(t.id,"id"))+hackeet.assert(t.io,"io"),hackeet.debug(null==t?"Null description":{error:"Missing Parameters",missing:e,description:t},"Widget Building ERROR")),a},this.record=function(t){var e,a,n,i,l;0!=k.is_valid_chart_definition(t)&&(e=k.widget_layout_id(t.id),a=t.io,l=t.title,i=hackeet.get_table_item_id(e,a,n=t.field)+k.m_count++,l=hackeet.widget_block(e+"::"+a,l,"",'<div id="'+i+'" class="hackeet-single-field"></div>',hackeet.get_block_unit(t.block_unit)),hackeet.dom_assign(e,l),k.m_js_client.add_handler(a,n,i,function(t){var e=document.getElementById(i);null!=e&&(e.innerHTML=t)}))};this.table=function(t,e){if(null!=t.id&&null!=e){var a,n=k.widget_layout_id(t.id),i={},l=t.io,r=hackeet.get_bootstrap_type(t.bootstrap_sm_type),s=(null!=e&&(i[l]=e[t.io]),""),_=null!=r;for(a in i){var o,c,u,d=i[a];null==d?hackeet.debug("Warning : unable to build table "+a+" : No valid server output"):(o="<tbody>",c=0,u=(d.fields.forEach(function(t){t='<tr class="'+(c++%2?"odd":"even")+'"> \t\t\t\t\t\t\t\t\t    <td class="hackeet_property">'+t+'</td>\t\t\t\t\t\t\t\t\t    <td class="hackeet_value" id="'+hackeet.get_table_item_id(n,a,t)+'"></td>\t\t\t\t\t\t\t\t\t</tr>';o+=t}),o+="</tbody>",'<div class="table-responsive hackeet_responsive_table"> <table class="display" id="dt1">'),d=null==d.title?a:d.title,u=u+('<thead><tr> <th class="hackeet-property-header">Property</th> <th class="hackeet-property-header">Value</th> </tr></thead>'+o)+"</table></div>",d=hackeet.widget_block(n+"::"+a,d,"",u,hackeet.get_block_unit(t.block_unit)),s+=d=_?r+d+"</div>":d)}if(""!=s){document.getElementById(n).innerHTML=s;var h,m=i,p=null,f=function(t,e){var a=hackeet.get_table_item_id(n,t,e);k.m_js_client.add_handler(t,e,a,function(t){var e=document.getElementById(a);null!=e&&(e.className="hackeet_value "+(HACKEET_CLASS_PREFIX+t),e.innerHTML=t)})};for(h in m)null!=p&&p(h),null!=f&&null!=m[h].fields&&m[h].fields.forEach(function(t){f(h,t)})}}},this.is_valid_widget_definition=function(t){return null!=t&&null!=t.io&&null!=t.id},this.get_widget=function(t,e){var a,n,i,l,r,s,_;return 0==k.is_valid_widget_definition(e)?null:(r=e.id,a=null==e.field?r:e.field,n=e.type,t=hackeet.standard_field_id(t,r),s=e.io,i={widget_id:r,field_id:t,field_name:a,placeholder:r=null==e.placeholder?a:e.placeholder,bot_input:s,persistent:e.persistent,synchronized:e.synchronized,value:e.value},l=e.io,n==TEXT_TAG?_='<div class="textarea-container"><textarea class="hackeet_textarea" id="'+t+'" name="'+a+'" placeholder="'+r+'"></textarea></div>':n==FORM_TAG?_=hackeet.standard_input_block(i,"text"):n==PASSWORD_TAG?_=hackeet.standard_input_block(i,"password"):n==CALENDAR_TAG?_=hackeet.standard_input_block(i,"date"):n==NUMBER_TAG?_=hackeet.standard_input_block(i,"number"):n==COLOR_TAG?_=hackeet.standard_input_block(i,"color"):n==DATE_TAG?_=hackeet.standard_input_block(i,"date"):n==EMAIL_TAG?_=hackeet.standard_input_block(i,"email"):n==UPLOAD_TAG?_=hackeet.standard_input_block(i,"file"):n==SUBMIT_BUTTON_TAG?_=hackeet.standard_input_block(i,"submit"):n==RADIO_TAG?_=hackeet.generic_list_input_block(l,a,t,s,e,{block_type:HACKEET_RADIO_BLOCK_TYPE,type:"radio",standard:"radio",inline:"radio-inline"},i):n==INLINE_RADIO_TAG?_=hackeet.generic_list_input_block(l,a,t,s,e,{block_type:HACKEET_RADIO_BLOCK_TYPE,type:"radio",standard:"radio-inline",inline:"radio-inline"},i):n==INLINE_CHECKBOX_TAG?_=hackeet.generic_list_input_block(l,a,t,s,e,{block_type:HACKEET_CHECKBOX_BLOCK_TYPE,type:"checkbox",standard:"checkbox-inline",inline:"checkbox"},i):n==CHECKBOX_TAG?_=hackeet.generic_list_input_block(l,a,t,s,e,{block_type:HACKEET_CHECKBOX_BLOCK_TYPE,type:"checkbox",standard:"checkbox",inline:"checkbox"},i):n==ONOFF_TAG&&(r=null!=e.off?e.off:"Off",s=null!=e.on?e.on:"On",_=hackeet.switch_input_block(l,a,s,r,"form_block_switch",i)),{id:t,str:_})},this.add_chart=function(t,e){null!=t&&null!=(t=k.chart(t,k.m_js_client,e))&&(t.show(),null!=e.id)&&(k.m_widgets_impl[e.id]=t)},this.add_widget=function(t,e,a){var n="";switch(null==e.type&&(e.type=FORM_TAG),e.type){case TEXT_TAG:case FORM_TAG:case PASSWORD_TAG:case CALENDAR_TAG:case NUMBER_TAG:case COLOR_TAG:case DATE_TAG:case EMAIL_TAG:case UPLOAD_TAG:case RADIO_TAG:case INLINE_RADIO_TAG:case CHECKBOX_TAG:case INLINE_CHECKBOX_TAG:case TEXT_TAG:case ONOFF_TAG:var i=(r=k.get_widget(hackeet.get_input_id(t,"form"),e)).str,l=k.widget_layout_id(e.id),n=r.id;null!=i&&hackeet.dom_assign(l,i);break;case SUBMIT_BUTTON_TAG:var r,i=(r=k.get_widget(hackeet.get_input_id(t,"form"),e)).str,l=k.widget_layout_submit_id(t);n=r.id,null!=i&&hackeet.dom_assign(l,i);break;case RECORD_CHART_TAG:k.record(e);break;case COLUMN_CHART_TAG:k.add_chart(k.chart_factory().column,e);break;case LINE_CHART_TAG:k.add_chart(k.chart_factory().line,e);break;case TABLE_CHART_TAG:k.add_chart(k.chart_factory().tablechart,e);break;case BUBBLE_CHART_TAG:k.add_chart(k.chart_factory().bubble,e);break;case DEFAULT_TABLE_TAG:k.table(e,a)}return n},this.widget_layout_id=function(t){return"layout_"+t},this.widget_layout_submit_id=function(t){return k.widget_layout_id("submit_"+t)},this.screen_layout=function(t){var e=t.id,t=t.definition,a=null==t?null:t.widgets;if(null==t||null==e||null==a)return"";var n,i="",l='<div class="cont">'+(i=null!=t.block_title&&""!=t.block_title?'<h1 class="hackeet-block-title">'+t.block_title+"</h1>":i)+' <form enctype="multipart/form-data" id="'+e+'" name="'+e+'">';for(n in a){var r,s,_,o=a[n];1==k.is_valid_widget_definition(o)&&(_='<div id="'+(_=k.widget_layout_id(o.id))+'" name="'+_+'" ></div>',r=o.type,1==(null!=o.label||r==CALENDAR_TAG||r==DATE_TAG||r==COLOR_TAG||r==UPLOAD_TAG)&&(r=o.label,s=o.field,s=null==o.placeholder?s:o.placeholder,_='<div class="row hackeet-element-block"><div class="col-md-2 hackeet-element-label">'+(null==r?s:r)+'</div><div class="col-md-10 hackeet-element-widget">'+_+"</div></div>"),l+=_)}t=k.widget_layout_submit_id(e);return l+='<div class="row"><div class="col-md-12" id="'+t+'" name="'+t+'"></div></div>'+"</form></div>"},this.form=function(t){var e;null!=t&&(e=t.form,$("#"+e).off("submit.hackeet"),$("#"+e).on("submit.hackeet",{form_id:e,io:t.io,redirect:t.redirect,callback:t.callback},function(t){var e=t.data.form_id,a=t.data.io,n=k.m_js_client.async_entry_url(a),i=t.data.redirect,l=t.data.callback;return null==a||null==n||null==e||(k.submit_form(t,n,t.data.form_id,""),null!=l&&l(t),null!=i&&(window.location.href=i),!1)}))},this.screen=function(l,t){var t=null==t?k.screen_layout(l):t,e=[],a={};if(null!=t&&""!=t){hackeet.dom_assign(l.target,t);var n,i=l.id,t=l.definition,r=t.widgets,s=i,_=!1;for(n in r){var o=r[n];null!=o&&(o=o.io,k.add_widget(i,r[n],l.outputs),null!=o&&null==a[o]&&(a[o]=!0,e.push(o)),_=!0)}var c=null!=t.button,u=s+"-submit-button",d=(1==c&&(u=k.add_widget(i,{value:t.button.label,type:SUBMIT_BUTTON_TAG,id:u,field:"",io:""},l.outputs)),function(t){return 13!==t.which}),h=function(t,e){var a=null!=t.data?t.data:{reset:!1,form_id:s},n=null!=a.inputs?a.inputs:[].concat($(this).attr("bot_input"));if(null!=n)for(var i in n){i=n[i],i=k.m_js_client.async_entry_url(i);t.preventDefault(),null!=l.submit_handler&&l.submit_handler(i,a.form_id),k.submit_form(t,i,a.form_id,"")}return 1==a.reset&&document.getElementById(a.form_id).reset(),!1},m=e,t=0!=hackeet.attribute(t,["gui","button","reset"])&&0!=t.reset;$("#"+s).submit({inputs:m,form_id:s,reset:t},0==c?function(t){t.preventDefault()}:h),$("#"+s+" .immediate").change({form_id:s},0==c?h:d),1==c&&($("#"+s+" .immediate").keypress(d),0==_)&&$("#"+u).on("click",{form:l},function(t){return p.service().post_form(k.m_js_client.async_entry_url(t.data.form.definition.title),null,{}),!1}),null==k.m_input_handler&&(k.m_input_handler=function(t,e){hackeet.set_state(t,e),hackeet.restore_state(HACKEET_SYNCHRONIZED_SELECTOR)},k.m_js_client.add_input_handler(HACKEET_DEFAULT_INPUT_HANDLER_ID,k.m_input_handler)),hackeet.load_states(k.m_js_client,e),hackeet.restore_state()}},this.default_screens=function(t){var e,a,n=t.inputs,i=[],l=0;for(e in n){var r=n[e],s={id:l++,title:e,button:{label:"Submit",reset:!0}},_=[];if(null!=r.arguments)for(var o in r.arguments)_.push({id:l++,io:e,field:o,type:"form"});s.widgets=_,i.push(s)}for(a in t.outputs){s={id:l++,title:a};(_=[]).push({id:l++,io:a,type:"output"}),s.widgets=_,i.push(s)}return i},this.chart=function(t,e,a){var n=k.widget_layout_id(a.id),i=a,a=null!=a.target&&""!=a.target?a.target:k.widget_layout_id(a.id);k.block(a,{title:null==i.title?i.name:i.title,content:'<div id="'+n+'" class="hackeet-chart-container"></div>'});return i.target=n,i.output=i.io,new t(e,i)},this.update_nav_bar=function(p,f){null!=f&&k.m_js_client.service().get(k.m_js_client.pages_url(),function(t){try{var e=f.default_pages,a=f.filter,n=f.add_default_home,i=f.need_logout,l=null==e?t:e.concat(t),r=hackeet.read_session_data("token"),s=hackeet.read_session_data("app_token"),_="",o=hackeet.read_session_data("home_url"),c="",_=_+("&token="+(null==r?"":r))+("&app_token="+(null==r?"":s));for(page_key in 1==(1==n)&&(c='<li class="hackeet-menu-item"><a href="'+(null==o?"/":o)+"?"+_+'"><i class="icon-home icon-white"></i> Home</a></li>'),l){var u=l[page_key],d=null!=u?u.title:null,h=null!=u?u.url:null,m=null==u.query?"":u.query;null==d||null==h||null!=a&&!a(h)||(c+='<li class="hackeet-menu-item"><a href="'+h+"?"+m+_+'"><i class="icon-white"></i>'+d+"</a></li>")}!i&&1!=f.need_auth||(c+='<li class="hackeet-menu-item hackeet-logout-menu-item"><a href="/"><i class="icon-lock icon-white"></i> Logout</a></li> '),document.getElementById(p).innerHTML=c}catch(t){alert(t)}})},this.widget_impl=function(t){return k.m_widgets_impl[t]}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.streamer=function(t,e){var s=this;this.m_records={},this.m_data_set=[[]],this.m_drawed=!1,this.m_headers=null,this.m_chart=e,this.m_stamp=1,this.m_options=t,this.m_transform=t.transform,this.m_initialized=!1,this.m_indices={},this.m_index=1,this.m_initialized=!1,this.add_headers=function(){return(null==s.m_options.no_headers||0==s.m_options.no_headers)&&null!=s.m_options.headers},this.initialize=function(){if(0==s.m_initialized){null!=s.m_options.no_headers&&0!=s.m_options.no_headers||s.m_options.headers;if(s.add_headers())for(var t=0;t<s.m_options.headers.length;++t)s.m_data_set[0][t]=s.m_options.headers[t].label;s.m_initialized=!0}},this.get_index=function(t){var e=s.m_indices[t];return null==e&&(e=s.m_index++,s.m_indices[t]=e),e},this.add_record=function(t){s.initialize();var e=t[s.m_options.key],a=null==s.m_records[e],n=s.get_index(e);s.m_records[t[s.m_options.key]]=t;for(var i=0;i<s.m_headers.length;++i){var l=s.m_headers[i],r=s.m_data_set[n],a=a||s.m_records[e][l]!==t[l];(r=null==r?[]:r)[i]="number"===s.m_options.headers[i].type?parseFloat(t[s.m_options.headers[i].field]):t[s.m_options.headers[i].field],s.m_data_set[n]=r}return s.m_stamp+=1,a},this.update=function(t,e){if(null!=s.m_options.key){if(null==s.m_headers&&(s.m_headers=[],null!=s.m_options.headers))for(var a=0;a<s.m_options.headers.length;++a)s.m_headers[a]=s.m_options.headers[a].field;var n,i=e[s.m_options.key];return null!=s.m_transform&&null!=(n=s.m_transform(s,i,e))&&(e=n),null!=s.m_chart.update&&s.m_chart.update(i,s.m_records,e),s.add_record(e)}},this.draw=function(){s.initialize(),s.m_chart.draw(s.m_data_set,s.m_records,s.m_options)},this.reset=function(){s.m_records={},s.m_data_set=[[]],s.m_drawed=!1,s.m_initialized=!1,s.m_index=s.add_headers()?1:0,s.m_indices={}},this.stamp=function(){return s.m_stamp},this.records=function(){return s.m_records},this.data_set=function(){return s.m_data_set},this.options=function(){return s.m_options},this.set_chart=function(t){s.m_chart=t},this.chart=function(){return s.m_chart}},hackeet.charts.start_streaming=function(t,e,a){function n(t,e){i.update(t,e),1==a.realtime&&i.draw()}var i=new hackeet.charts.streamer(a,e);return a.streaming&&t.register_handler({output_id:a.streaming,handler_id:String(a.handler_id)+"_streaming"},n),a.initialization&&t.register_handler({output_id:a.initialization,handler_id:String(a.handler_id)+"_initialize"},n),a.initialize&&a.initialize(),i},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.google=null==hackeet.charts.google?{}:hackeet.charts.google,hackeet.charts.google.bubble=function(a,t){var i=this;this.m_options=t,this.m_dataset_options=t.data,this.m_data_transform=null,this.m_chart=null,this.max_y_value=null,this.max_x_value=null,this.m_streamer=null,this.m_visible=!0,this.chart=function(){return i.m_chart},this.target=function(){return i.m_options.target};this.update=function(t,e,a){var n;null!=i.m_data_transform&&null!=(n=i.m_data_transform(a))&&(a=n),(null==i.max_x_value||i.max_x_value<a[i.m_dataset_options.x.field])&&(i.max_x_value=a[i.m_dataset_options.x.field]),(null==i.max_y_value||i.max_y_value<a[i.m_dataset_options.y.field])&&(i.max_y_value=a[i.m_dataset_options.y.field])},this.allocate_streamer=function(t){var e={key:i.m_dataset_options.key.field,headers:i.m_headers,streaming:i.m_options.io,initialization:null,initialize:null,realtime:null==i.m_options.realtime||i.m_options.realtime,change_only:!0,handler_id:t,transform:i.m_options.transform};return i.m_chart=new google.visualization.BubbleChart(document.getElementById(t)),null==i.m_options.change_only&&(e.change_only=!0),null==i.m_options.handler_id&&(e.handler_id=t),i.m_streamer=hackeet.charts.start_streaming(a,i,e),i.m_streamer},this.draw=function(t,e){i.m_chart.clearChart(),i.m_chart.draw(google.visualization.arrayToDataTable(t),(null==(t=i.m_options).hAxis&&(t.hAxis={}),null==t.vAxis&&(t.vAxis={}),t.hAxis.minValue=-.4*i.max_x_value,t.hAxis.maxValue=1.4*i.max_x_value,t.vAxis.minValue=-.4*i.max_y_value,t.vAxis.viewWindow="pretty",t.vAxis.maxValue=1.4*i.max_y_value,i.set_chart_options(i.m_options)))},this.refresh=function(){null!=i.m_streamer&&i.m_streamer.draw()},this.show=function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){i.m_headers=[i.m_dataset_options.key,i.m_dataset_options.x,i.m_dataset_options.y,i.m_dataset_options.group,i.m_dataset_options.size],i.m_streamer=i.allocate_streamer(i.m_options.target),i.m_streamer.draw()})},this.set_chart_options=function(t){return hackeet.deep_clone(i.m_options.display.google,t),i.max_y_value=null,i.max_x_value=null,i.m_options.display.google},this.clear=function(){null!=i.m_chart&&i.m_chart.clearChart(),null!=i.m_streamer&&i.m_streamer.reset(),i.max_y_value=null,i.max_x_value=null}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.google=null==hackeet.charts.google?{}:hackeet.charts.google,hackeet.charts.google.column=function(a,t){var i=this;this.m_options=t,this.m_dataset_options=t.data,this.m_chart=null,this.m_streamer=null,this.m_headers=[],this.m_headers_label=[],this.m_initialized=!1,this.chart=function(){return i.m_chart},this.target=function(){return i.m_options.target},this.allocate_streamer=function(t){var e={key:i.m_dataset_options.key,headers:i.m_headers,streaming:i.m_options.io,initialization:null,initialize:null,realtime:null!=i.m_options.realtime&&i.m_options.realtime,transform:i.m_options.transform};return i.m_chart=new google.visualization.ColumnChart(document.getElementById(t)),null==i.m_options.change_only&&(e.change_only=!0),null==i.m_options.handler_id&&(e.handler_id=t),hackeet.charts.start_streaming(a,i,e)},this.draw=function(t,e){var a=[];a.push(i.m_headers_label.slice());for(var n=1;n<t.length;++n)a.push(t[n].slice());i.m_chart.draw(google.visualization.arrayToDataTable(a),i.m_options.display.google)},this.show=function(){google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(function(){var t=i.m_dataset_options.records;if(0==i.m_initialized){i.m_headers=[],i.m_headers_label=[],i.m_headers.push({field:i.m_dataset_options.key}),i.m_headers_label.push(i.m_dataset_options.key),i.m_initialized=!0;for(var e=0;e<t.length;++e){var a=t[e],n=null!=a.label?a.label:a.field;i.m_headers.push(a),i.m_headers_label.push(n)}}i.m_streamer=i.allocate_streamer(i.m_options.target),i.m_streamer.draw()})},this.clear=function(){i.m_streamer.reset(),i.show()},this.refresh=function(){null!=i.m_streamer&&i.m_streamer.draw()}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.google=null==hackeet.charts.google?{}:hackeet.charts.google,hackeet.charts.google.line=function(a,t){var u=this;this.m_options=t,this.m_dataset_options=t.data,this.m_chart=null,this.indices={},this.m_data_table=[[]],this.m_last_row=null,this.m_last_rank=-1,this.m_internal_rank=0,this.m_rank_increment=1e-4,this.chart=function(){return u.m_chart},this.target=function(){return u.m_options.target},this.allocate_streamer=function(t){var e={key:u.m_dataset_options.key,headers:u.m_headers,streaming:u.m_options.io,initialization:null,initialize:null,realtime:null!=u.m_options.realtime&&u.m_options.realtime,change_only:!0,handler_id:t,transform:u.m_options.transform};return u.m_chart=new google.visualization.LineChart(document.getElementById(t)),null==u.m_options.change_only&&(e.change_only=!0),null==u.m_options.handler_id&&(e.handler_id=t),hackeet.charts.start_streaming(a,u,e)};this.draw=function(t,e){u.chart_handler;var a,n=null,i=u.m_last_rank,l=u.m_last_row;for(a in e){var r=u.indices[a];if(null==r){(r={}).index=u.m_data_table[0].length,u.indices[a]=r,u.m_data_table[0][r.index]=a;for(var s=1;s<u.m_data_table.length;++s)u.m_data_table[s].push(0)}_=a,c=e,void 0,o=void 0,o=u.m_internal_rank+=u.m_rank_increment;var _,o={rank:o=null==u.m_dataset_options.rank?o:c[_][u.m_dataset_options.rank],label:String(null==u.m_dataset_options.label?o:c[_][u.m_dataset_options.label])},c=o.rank;c>=u.m_last_rank&&(null==(n=c>u.m_last_rank?null:u.m_last_row)&&(_=u.m_data_table[0],(n=u.m_data_table[u.m_data_table.length-1].slice())[0]=o.label,i=c,l=n,u.m_data_table.length>=u.m_dataset_options.depth&&u.m_data_table.shift(),u.m_data_table.push(n),u.m_data_table[0]=_),n[r.index]=e[a][u.m_dataset_options.value])}u.m_last_rank=i,u.m_last_row=l,u.m_chart.clearChart(),u.m_chart.draw(google.visualization.arrayToDataTable(u.m_data_table),u.m_options.display.google)},this.show=function(){u.m_data_table[0][0]="index",google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){u.m_headers=[{field:u.m_dataset_options.key,label:u.m_dataset_options.key},{field:u.m_dataset_options.value,label:u.m_dataset_options.value,type:"number"}],u.m_streamer=u.allocate_streamer(u.m_options.target),u.m_streamer.draw()})},this.clear=function(){u.m_data_table=[],u.m_data_table[0][0]="index"},this.streamer=function(){return u.m_streamer}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.plotly=null==hackeet.charts.plotly?{}:hackeet.charts.plotly,hackeet.charts.plotly.bubble=function(a,t){var A=this;this.m_options=t,this.m_headers=null,this.m_dataset_options=t.data,this.m_data_transform=null,this.m_chart=null,this.m_alpha=.1,this.m_bubble_min_size=20,this.m_bubble_max_size=80,this.m_bubble_font_size=8,this.m_min_bubble_label_size=20,this.m_group_colors={},this.m_color_index=0,this.m_traces={},this.m_streamer=null,this.m_visible=!0,this.m_layout=null!=t&&null!=t.display&&null!=t.display.plotly&&null!=t.display.plotly.layout?t.display.plotly.layout:null,this.chart=function(){return A.m_chart},this.target=function(){return A.m_options.target},this.get_size=function(t,e,a){var n=A.m_bubble_min_size,i=A.m_bubble_max_size;return t<=e||a-e<=0?n:a<=t?i:n*(1-(n=(t-e)/(a-e)))+n*i},this.get_color=function(t){var e=A.m_group_colors[t];return e=null==e?A.m_group_colors[t]=this.m_color_index++:e},this.legend=function(t){var e=A.m_options.display.plotly.hovering_fields,a=null==e||0==e.length?A.m_headers:e,n="",i="";if(null!=a)for(var l=0;l<a.length;++l){var r=a[l],s=r.label;s.trim(),n+=""!=s?i+r.label+":"+t[r.field]:i+t[r.field],i="</br>"}return n},this.set_chart_options=function(t){hackeet.default_allocate(A.m_options),hackeet.default_allocate(A.m_options.display);var e=A.m_options.display.plotly;return null!=t&&(deep_clone(A.m_options.display.plotly,t),null!=e.alpha&&(this.m_alpha=alpha),null!=e.bubble_min_size&&(this.m_bubble_min_size=bubble_min_size),null!=e.bubble_max_size&&(this.m_bubble_max_size=bubble_max_size),null!=e.bubble_font_size&&(this.m_bubble_font_size=bubble_font_size),null!=e.min_bubble_label_size)&&(this.m_min_bubble_label_size=min_bubble_label_size),e},this.allocate_streamer=function(t){var e={key:A.m_dataset_options.key.field,headers:A.m_headers,streaming:A.m_options.io,initialization:null,initialize:null,realtime:null==A.m_options.realtime||A.m_options.realtime,change_only:!0,handler_id:t,transform:A.m_options.transform};return null==A.m_options.change_only&&(e.change_only=!0),null==A.m_options.handler_id&&(e.handler_id=t),A.m_streamer=hackeet.charts.start_streaming(a,A,e),A.m_streamer},this.draw=function(t,e){if(hackeet.dom_exists(A.m_options.target)&&null!=t){for(var a,n=null,i=null,l=null,r=null,s=null,_=null,o=1;o<t.length;++o)null!=(k=t[o])&&(m=k[1],p=k[2],a=k[4],n=null!=n&&n<=m?n:m,l=null!=l&&l<=p?l:p,s=null!=s&&s<=a?s:a,i=null!=i&&m<=i?i:m,r=null!=r&&p<=r?r:p,_=null!=_&&a<=_?_:a);var c=A.m_layout,u=i-n,d=r-l,h=(null==(c=null==c?{}:c).xaxis&&(c.xaxis={}),null==c.yaxis&&(c.yaxis={}),c.title=A.m_options.display.plotly.title,c.xaxis.range=[n-A.m_alpha*u,i+A.m_alpha*u],c.yaxis.range=[l-A.m_alpha*d,r+A.m_alpha*d],{}),m=[],p=[],f=A.m_options.display.plotly.opacity;null==f&&(f=1);for(var k,b,g,y,o=1;o<t.length;++o)null!=(k=t[o])&&(b=h[v=k[3]],g=A.get_size(k[4],s,_),null==b&&((b=null==(b=hackeet.deep_clone(h[v],A.m_options.display.plotly.trace))?{mode:"markers"}:b).marker={color:[],size:[],opacity:[]},b.name=v,b.x=[],b.y=[],b.text=[],h[v]=b),y=b.x.length,b.x[y]=k[1],b.y[y]=k[2],b.text[y]=g>=A.m_min_bubble_label_size?A.legend(e[k[0]]):"",b.marker.size[y]=g,b.marker.color[y]=hackeet.dataset_color(A.get_color(v)),b.marker.opacity[y]=f);var v,T=[],w=0;for(v in h)T[w++]=h[v];1==A.m_visible&&(A.m_chart=Plotly.react(A.m_options.target,T,c))}},this.refresh=function(){null!=A.m_streamer&&A.m_streamer.draw()},this.show=function(){A.set_chart_options(),A.m_headers=[A.m_dataset_options.key,A.m_dataset_options.x,A.m_dataset_options.y,A.m_dataset_options.group,A.m_dataset_options.size],A.m_streamer=A.allocate_streamer(A.m_options.target),A.m_streamer.draw()},this.clear=function(){null!=A.m_streamer&&(A.m_streamer.reset(),A.draw())},this.visible=function(t){0==(A.m_visible=t)?Plotly.purge(A.m_options.target):A.m_streamer.draw()}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.plotly=null==hackeet.charts.plotly?{}:hackeet.charts.plotly,hackeet.charts.plotly.column=function(e,t){var l=this;this.m_options=t,this.m_dataset_options=t.data,this.m_chart=null,this.m_streamer=null,this.m_headers=[],this.m_headers_label=[],this.m_initialized=!1,this.m_layout=null!=t&&null!=t.display&&null!=t.display.plotly&&null!=t.display.plotly.layout?t.display.plotly.layout:null,this.chart=function(){return l.m_chart},this.target=function(){return l.m_options.target},this.allocate_streamer=function(t){t={key:l.m_dataset_options.key,headers:l.m_headers,streaming:l.m_options.io,initialization:null,initialize:null,realtime:null!=l.m_options.realtime&&l.m_options.realtime,change_only:!0,handler_id:t,transform:l.m_options.transform};return hackeet.charts.start_streaming(e,l,t)},this.draw=function(t,e){if(hackeet.dom_exists(l.m_options.target)){for(var a=[],n=[],i=1;i<t.length;i++)a[i-1]=t[i][0],n[i-1]=t[i][1];Plotly.react(l.m_options.target,[{x:a,y:n,type:"bar"}],l.m_layout)}},this.show=function(){l.m_options;var t=l.m_dataset_options.records;if(0==l.m_initialized){l.m_headers=[],l.m_headers_label=[],l.m_headers.push({field:l.m_dataset_options.key}),l.m_headers_label.push(l.m_dataset_options.key),l.m_initialized=!0;for(var e=0;e<t.length;++e){var a=t[e],n=null!=a.label?a.label:a.field;l.m_headers.push(a),l.m_headers_label.push(n)}}l.m_streamer=l.allocate_streamer(l.m_options.target),l.m_streamer.draw()},this.clear=function(){l.m_streamer.reset(),l.show()},this.refresh=function(){null!=l.m_streamer&&l.m_streamer.draw()}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.plotly=null==hackeet.charts.plotly?{}:hackeet.charts.plotly,hackeet.charts.plotly.line=function(a,t){var b=this;this.m_options=t,this.m_dataset_options=t.data,this.m_chart=null,this.indices={},this.m_data_table=[[]],this.m_last_row=null,this.m_last_rank=-1,this.m_internal_rank=0,this.m_rank_increment=1e-4,this.m_layout=null!=t&&null!=t.display&&null!=t.display.plotly&&null!=t.display.plotly.layout?t.display.plotly.layout:null,this.chart=function(){return b.m_chart},this.target=function(){return b.m_options.target},this.allocate_streamer=function(t){var e={key:b.m_dataset_options.key,headers:b.m_headers,streaming:b.m_options.io,initialization:null,initialize:null,realtime:null!=b.m_options.realtime&&b.m_options.realtime,change_only:!0,handler_id:t,transform:b.m_options.transform};return null==b.m_options.change_only&&(e.change_only=!0),null==b.m_options.handler_id&&(e.handler_id=t),hackeet.charts.start_streaming(a,b,e)};this.draw=function(t,e){if(hackeet.dom_exists(b.m_options.target)){b.chart_handler;var a,n=null,i=b.m_last_rank,l=b.m_last_row;for(a in e){var r=b.indices[a];if(null==r){(r={}).index=b.m_data_table[0].length,b.indices[a]=r,b.m_data_table[0][r.index]=a;for(var s=1;s<b.m_data_table.length;++s)b.m_data_table[s].push(0)}_=a,c=e,void 0,o=void 0,o=b.m_internal_rank+=b.m_rank_increment;var _,o={rank:o=null==b.m_dataset_options.rank?o:c[_][b.m_dataset_options.rank],label:String(null==b.m_dataset_options.label?o:c[_][b.m_dataset_options.label])},c=o.rank;c>=b.m_last_rank&&(null==(n=c>b.m_last_rank?null:b.m_last_row)&&(_=b.m_data_table[0],(n=b.m_data_table[b.m_data_table.length-1].slice())[0]=o.label,i=c,l=n,b.m_data_table.length>=b.m_dataset_options.depth&&b.m_data_table.shift(),b.m_data_table.push(n),b.m_data_table[0]=_),n[r.index]=e[a][b.m_dataset_options.value])}b.m_last_rank=i,b.m_last_row=l;for(var u=b.m_data_table[0],d=[],h=[],s=1;s<u.length;++s)d[s-1]={name:u[s],x:[],y:[]},Object.assign(d[s-1],b.m_options.display.plotly);for(var m=1;m<b.m_data_table.length;++m){var p=b.m_data_table[m];h[m-1]=p[0];for(var f=1;f<p.length;++f)d[f-1].y[m-1]=p[f]}for(var k=0;k<d.length;++k)d[k].x=h;Plotly.react(b.m_options.target,d,b.m_layout)}},this.show=function(){b.m_data_table[0][0]="index",b.m_headers=[{field:b.m_dataset_options.key,label:b.m_dataset_options.key},{field:b.m_dataset_options.value,label:b.m_dataset_options.value,type:"number"}],b.m_streamer=b.allocate_streamer(b.m_options.target),b.m_streamer.draw()},this.clear=function(){b.m_data_table=[],b.m_data_table[0][0]="index",null!=b.m_streamer&&(b.m_streamer.reset(),b.draw())},this.streamer=function(){return b.m_streamer}},hackeet.charts=null==hackeet.charts?{}:hackeet.charts,hackeet.charts.plotly=null==hackeet.charts.plotly?{}:hackeet.charts.plotly,hackeet.charts.plotly.tablechart=function(e,t){var u=this;this.m_options=t,this.m_dataset_options=t.data,this.m_chart=null,this.m_streamer=null,this.m_headers=[],this.m_headers_label=[],this.m_initialized=!1,this.m_layout=null!=t&&null!=t.display&&null!=t.display.plotly&&null!=t.display.plotly.layout?t.display.plotly.layout:null,this.chart=function(){return u.m_chart},this.target=function(){return u.m_options.target},this.allocate_streamer=function(t){t={key:u.m_dataset_options.key,headers:u.m_headers,streaming:u.m_options.io,initialization:null,initialize:null,realtime:null!=u.m_options.realtime&&u.m_options.realtime,change_only:!0,handler_id:t,transform:u.m_options.transform};return hackeet.charts.start_streaming(e,u,t)},this.draw=function(t,e){if(hackeet.dom_exists(u.m_options.target)){for(var a=[],n=(1==u.m_options.data.sort?(Object.assign(a,t),a.sort()):a=t,a[0]),i=[],l=[],r=1;r<n.length;++r){var s=[];s.push(n[r]),i.push(s)}for(r=1;r<a.length;++r)for(var _=a[r],o=1;o<_.length;++o){l[o-1];null==l[o-1]&&(l[o-1]=[]),l[o-1].push(_[o])}var t=null!=u.m_options.display.plotly?u.m_options.display.plotly.header:{},c=null!=u.m_options.display.plotly?u.m_options.display.plotly.cells:{};null==c&&(c=[]),(t=null==t?[]:t).values=i,c.values=l,Plotly.react(u.m_options.target,[{type:"table",header:t,cells:c}],u.m_layout)}},this.show=function(){u.m_options;var t=u.m_dataset_options.records;if(0==u.m_initialized){u.m_headers=[],u.m_headers_label=[],u.m_headers.push({field:u.m_dataset_options.key}),u.m_headers_label.push(u.m_dataset_options.key),u.m_initialized=!0;for(var e=0;e<t.length;++e){var a=t[e],n=null!=a.label?a.label:a.field;u.m_headers.push(a),u.m_headers_label.push(n)}}u.m_streamer=u.allocate_streamer(u.m_options.target),u.m_streamer.draw()},this.clear=function(){u.m_streamer.reset(),u.show()},this.refresh=function(){null!=u.m_streamer&&u.m_streamer.draw()}};